server:
  port: 8081


spring:

  # ======================================================
  # FILE UPLOAD
  # ======================================================
  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB


  # ======================================================
  # DATASOURCE (PostgreSQL + HikariCP)  ‚≠ê QUAN TR·ªåNG NH·∫§T
  # ======================================================
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: ${POSTGRES_URL}
    username: ${POSTGRES_USER}
    password: ${POSTGRES_PASSWORD}
    driver-class-name: org.postgresql.Driver

    hikari:
      pool-name: CourseHikariPool

      # ‚ö° tƒÉng t·ªëc seed / batch insert
      maximum-pool-size: 30
      minimum-idle: 10

      auto-commit: false
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      leak-detection-threshold: 0


  # ======================================================
  # JPA / HIBERNATE (BATCH INSERT OPTIMIZED)
  # ======================================================
  jpa:
    open-in-view: false          # ‚úÖ ƒë√∫ng best practice
    show-sql: false             # ‚ùå t·∫Øt ƒë·ªÉ seed nhanh h∆°n
    hibernate:
      ddl-auto: update

    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

        # üî• C·ª∞C K·ª≤ QUAN TR·ªåNG CHO SEED NHANH
        jdbc:
          batch_size: 1000
          batch_versioned_data: true

        order_inserts: true
        order_updates: true

        format_sql: false
        generate_statistics: false


  # ======================================================
  # REDIS CACHE
  # ======================================================
  cache:
    type: redis
    redis:
      time-to-live: 3600000

  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${PRIMARY_KEY}
      timeout: 30s

      lettuce:
        pool:
          max-active: 20
          max-idle: 10
          min-idle: 5
        client-options:
          protocol-version: RESP2


# ======================================================
# APP CONFIG
# ======================================================
app:
  security:
    jwt:
      access-expires-at: 36000000
      refresh-expires-at: 60480000000
      prefix: Bearer
      auth-header: Authorization
      access-secret: access-secret
      refresh-secret: refresh-secret

  api:
    base-url-api: http://localhost:8081
    title: COURSE APP
    version: 1.0.0
    contact-email: ngtbang2264.dev@gmail.com
    swagger:
      enable: true


# ======================================================
# LOGGING (GI·∫¢M LOG ƒê·ªÇ TƒÇNG T·ªêC)
# ======================================================
logging:
  level:
    root: INFO
    com.example.course: DEBUG

    # ‚ùå t·∫Øt SQL spam
    org.hibernate.SQL: WARN
    org.hibernate.orm.jdbc.bind: WARN

    org.springframework.data.redis: WARN
    org.springframework.security: INFO
